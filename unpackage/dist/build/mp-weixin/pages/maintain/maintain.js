(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/maintain/maintain"],{"419c":function(t,e,a){"use strict";var n=a("5e0f"),s=a.n(n);s.a},"5e0f":function(t,e,a){},6215:function(t,e,a){"use strict";a.r(e);var n=a("f7a2"),s=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e["default"]=s.a},"675d":function(t,e,a){},daeb:function(t,e,a){"use strict";var n=a("675d"),s=a.n(n);s.a},e0ae:function(t,e,a){"use strict";(function(t){a("9112"),a("921b");n(a("66fd"));var e=n(a("fa3c"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},f7a2:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("01a8");var n=s(a("d132"));function s(t){return t&&t.__esModule?t:{default:t}}var i=function(){return a.e("components/uni-popup/uni-popup").then(a.bind(null,"837e"))},o=function(){return a.e("components/selectFoodsList").then(a.bind(null,"c1b5"))},c=function(){return a.e("components/selectTime").then(a.bind(null,"03c4"))},u={components:{selectlist:o,selecttime:c,uniPopup:i},data:function(){return{type:"",fdtype:"",height:0,heights:0,currentIndex:0,foodSTop:0,selectStatus:"",dataList:[],today:0,nextMonth:{},mealList:[],foodsList:[],foodsLists:[],selectDateList:[],tap:0,setLocalData:[],selectD:null}},watch:{},onShow:function(){t.getNetworkType({success:function(e){"none"==e.networkType&&t.reLaunch({url:"/pages/notNetwork/notNetwork"})}})},onLoad:function(){this.getDatas()},methods:{getDatas:function(){var e=this;this.selectDateList=[],this.heights=Number(t.getSystemInfoSync().windowHeight)-140;var a=this;a.getNewDate(),a.getNestDate(),this.$api.GetCategoryListAsync().then(function(t){e.mealList=t.data,e.selectStatus=t.data[0].categoryGuid}).catch(function(t){}),a.$api.GetUseFullDateListAsync().then(function(s){console.log(s),s.data.length>0?new Promise(function(t,e){s.data.forEach(function(t){var e=t.menuDate.split("T")[0].split("-")[0],s=t.menuDate.split("T")[0].split("-")[1],i=t.menuDate.split("T")[0].split("-")[2];a.selectDateList.push({week:n.default.judgeWeek(e,s,i),month:s+"-"+i,y:e}),a.setLocalData.push({y:e,m:s,d:i,isNull:!1})}),t(s.data[0].menuDate)}).then(function(t){a.selectD=t,a.getNewDate(),a.getNestDate(),e.$api.GetCategoryListAsync().then(function(n){e.mealList=n.data,e.selectStatus=n.data[0].categoryGuid,e.getFoodsList(a.selectStatus,t),e.addFoodsList(t)}).catch(function(t){})}):t.getStorage({key:"selectDate",success:function(t){t.data.forEach(function(t){t.forEach(function(t){a.selectDateList.push({week:n.default.judgeWeek(t.year,t.month,t.data),month:t.month+"-"+t.data,y:t.year})})}),a.selectD=t.data[0][0].year+"-"+t.data[0][0].month+"-"+t.data[0][0].data}})}).catch(function(t){}),this.height=Number(t.getSystemInfoSync().windowHeight)-55},togglePopup:function(t){this.type=t},toggleFdPopup:function(t){this.addFoodsList(this.selectD),this.fdtype=t},selectDataTap:function(e,a,n){this.tap=e;t.getStorageSync("thisYear");var s=n+"-"+a;this.selectD=s,this.getFoodsList(this.selectStatus,s)},getFoodsList:function(t,e){var a=this;this.$api.GetDisheMaintenanceAsync({Date:e,CategoryGuid:t}).then(function(t){a.foodsList=t.data}).catch(function(t){})},saveSetup:function(t){var e=this;console.log(t);var a=t.where(function(t){return 1==t.isChecked}).select(function(t){return t.dishesGuid});this.$api.AddDisheMaintenanceAsync({Date:this.selectD,CategoryGuid:this.selectStatus,DishesGuidArr:a}).then(function(t){0==t.code&&(e.fdtype="",e.setLocalData.push({y:e.selectD.split("-")[0],m:e.selectD.split("-")[1],d:e.selectD.split("-")[2],isNull:!1}),e.getFoodsList(e.selectStatus,e.selectD),e.getDatas(),e.saveData())}).catch(function(t){})},checkboxChange:function(t){this.$set(t,"isChecked",!t.isChecked)},addFoodsList:function(t){var e=this;this.$api.GetCheckedDisheMaintenanceAsync({Date:t,CategoryGuid:this.selectStatus}).then(function(t){e.foodsLists=t.data}).catch(function(t){})},select:function(t){this.currentIndex=t,this.selectStatus=this.mealList[t].categoryGuid,this.getFoodsList(this.selectStatus,this.selectD)},selectDate:function(t,e){return!(t.data<=e)&&(!t.isLock&&(this.$set(t,"isLock",!1),void this.$set(t,"isSelect",!t.isSelect)))},selectTime:function(){var e=[],a=this;this.dataList.forEach(function(t){var a=[];a=t.data.filter(function(t){return 1==t.isSelect&&!t.isLock}),a.length>0&&e.push(a)}),0==e.length?t.showToast({title:"请选择日期",icon:"none",mask:!0}):(e.forEach(function(t){t.forEach(function(t){a.selectDateList.push({week:n.default.judgeWeek(t.year,t.month,t.data),month:t.month+"-"+t.data,y:t.year})})}),t.setStorage({key:"selectDate",data:e,success:function(){a.type="",a.selectD=a.selectDateList[0].y+"-"+a.selectDateList[0].month}}))},getNewDate:function(e){var a=t.getStorageSync("thisYear"),n=new Date(e).getFullYear(),s=new Date(e).getMonth()+1;new Date(e).getDate();this.nextMonth={y:n,m:s},this.today=a.d;var i=a.y+"年"+a.m+"月";this.saveData(i,this.judgeOneWeek(a.y,a.m),this.computeMonth(a.y,a.m),this.today,a.m,a.y)},getNestDate:function(){this.dataList=[];var e=t.getStorageSync("thisYear"),a=e.y,n=e.m+1;n>12&&(a=e.y+1);var s=a+"年"+n+"月";this.saveData(s,this.judgeOneWeek(a,n),this.computeMonth(a,n),0,n,a)},computeMonth:function(t,e){var a=new Date(t,e,0);return a.getDate()},judgeOneWeek:function(t,e){return parseInt(new Date(new Date(t+"/"+e+"/1").getTime()).getDay())},saveData:function(t,e,a,n,s,i){var o=[],c=this;new Promise(function(t,e){for(var n=0,u=a;n<u;n++)o.push({data:n+1,month:s,year:i,isLock:!1,isSelect:!1,hasFoods:!1});for(n=0,u=o.length;n<u;n++)for(var h=0,r=c.setLocalData.length;h<r;h++)o[n].year==c.setLocalData[h].y&&o[n].month==c.setLocalData[h].m&&o[n].data==c.setLocalData[h].d&&(o[n].isLock=!0,o[n].isSelect=!0);t()}).then(function(){c.dataList.push({dataTime:t,nodata:e,data:o,toDay:n})})}}};e.default=u}).call(this,a("543d")["default"])},f9f8:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},s=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return s})},fa3c:function(t,e,a){"use strict";a.r(e);var n=a("f9f8"),s=a("6215");for(var i in s)"default"!==i&&function(t){a.d(e,t,function(){return s[t]})}(i);a("419c"),a("daeb");var o=a("2877"),c=Object(o["a"])(s["default"],n["a"],n["b"],!1,null,null,null);e["default"]=c.exports}},[["e0ae","common/runtime","common/vendor"]]]);